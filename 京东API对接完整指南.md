# ğŸ›’ BuildMaster - äº¬ä¸œè”ç›ŸAPIå¯¹æ¥å®Œæ•´æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [åŠŸèƒ½æ¦‚è¿°](#åŠŸèƒ½æ¦‚è¿°)
2. [ç”³è¯·äº¬ä¸œè”ç›ŸAPI](#ç”³è¯·äº¬ä¸œè”ç›Ÿapi)
3. [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
4. [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
5. [APIæ¥å£è¯´æ˜](#apiæ¥å£è¯´æ˜)
6. [å®šæ—¶ä»»åŠ¡è¯´æ˜](#å®šæ—¶ä»»åŠ¡è¯´æ˜)
7. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

BuildMaster å·²æˆåŠŸé›†æˆäº¬ä¸œè”ç›Ÿå¼€æ”¾å¹³å°APIï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

- âœ… **å•†å“æœç´¢** - æ ¹æ®å…³é”®è¯æœç´¢äº¬ä¸œå•†å“
- âœ… **å•†å“è¯¦æƒ…** - è·å–å•†å“è¯¦ç»†ä¿¡æ¯
- âœ… **ä»·æ ¼æŸ¥è¯¢** - å®æ—¶æŸ¥è¯¢å•†å“æœ€æ–°ä»·æ ¼
- âœ… **æ‰¹é‡ä»·æ ¼æ›´æ–°** - æ‰¹é‡æ›´æ–°æ‰€æœ‰é…ä»¶ä»·æ ¼
- âœ… **æ¨å¹¿é“¾æ¥ç”Ÿæˆ** - ç”Ÿæˆäº¬ä¸œè”ç›Ÿæ¨å¹¿é“¾æ¥
- âœ… **å®šæ—¶æ›´æ–°** - è‡ªåŠ¨å®šæ—¶æ›´æ–°ä»·æ ¼å’Œæ¨å¹¿é“¾æ¥
- âœ… **æ‰‹åŠ¨è§¦å‘** - æ”¯æŒæ‰‹åŠ¨è§¦å‘ä»·æ ¼æ›´æ–°

---

## ğŸ”‘ ç”³è¯·äº¬ä¸œè”ç›ŸAPI

### æ­¥éª¤1: æ³¨å†Œäº¬ä¸œè”ç›Ÿè´¦å·

1. è®¿é—®äº¬ä¸œè”ç›Ÿå®˜ç½‘: https://union.jd.com
2. ç‚¹å‡»ã€Œå…è´¹æ³¨å†Œã€ï¼Œä½¿ç”¨äº¬ä¸œè´¦å·ç™»å½•
3. å®Œæˆå®åè®¤è¯å’Œè”ç›Ÿè´¦å·æ¿€æ´»

### æ­¥éª¤2: åˆ›å»ºæ¨å¹¿ä½

1. ç™»å½•åå°ï¼Œè¿›å…¥ã€Œæ¨å¹¿ç®¡ç†ã€-> ã€Œæ¨å¹¿ä½ç®¡ç†ã€
2. ç‚¹å‡»ã€Œæ–°å»ºæ¨å¹¿ä½ã€
3. é€‰æ‹©æ¨å¹¿ä½ç±»å‹ï¼ˆå»ºè®®é€‰æ‹©ã€Œç½‘ç«™æ¨å¹¿ã€ï¼‰
4. å¡«å†™æ¨å¹¿ä½åç§°ï¼ˆå¦‚ï¼šBuildMasterè£…æœºå¹³å°ï¼‰
5. è®°å½•æ¨å¹¿ä½IDï¼ˆsite-idï¼‰ï¼Œä¾‹å¦‚ï¼š`1234567`

### æ­¥éª¤3: ç”³è¯·APIæƒé™

1. è¿›å…¥ã€Œå¼€æ”¾å¹³å°ã€-> ã€ŒAPIæƒé™ç”³è¯·ã€
2. ç”³è¯·ä»¥ä¸‹APIæƒé™ï¼š
   - âœ… å•†å“æŸ¥è¯¢API (`jd.union.open.goods.query`)
   - âœ… å•†å“è¯¦æƒ…API (`jd.union.open.goods.promotiongoodsinfo.query`)
   - âœ… æ¨å¹¿é“¾æ¥API (`jd.union.open.promotion.common.get`)
3. ç­‰å¾…å®¡æ ¸é€šè¿‡ï¼ˆä¸€èˆ¬1-3ä¸ªå·¥ä½œæ—¥ï¼‰

### æ­¥éª¤4: è·å–AppKeyå’ŒAppSecret

1. è¿›å…¥ã€Œè´¦æˆ·è®¾ç½®ã€-> ã€Œåº”ç”¨ç®¡ç†ã€
2. åˆ›å»ºæ–°åº”ç”¨æˆ–ä½¿ç”¨é»˜è®¤åº”ç”¨
3. è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **AppKey**: åº”ç”¨Keyï¼ˆä¾‹å¦‚ï¼š`abc123456`ï¼‰
   - **AppSecret**: åº”ç”¨å¯†é’¥ï¼ˆä¾‹å¦‚ï¼š`def789012`ï¼‰

---

## âš™ï¸ é…ç½®è¯´æ˜

### æ–¹å¼1: ç¯å¢ƒå˜é‡é…ç½®ï¼ˆæ¨èï¼‰

```bash
# Linux/Mac
export JD_APP_KEY=your_app_key
export JD_APP_SECRET=your_app_secret
export JD_SITE_ID=your_site_id

# Windows PowerShell
$env:JD_APP_KEY="your_app_key"
$env:JD_APP_SECRET="your_app_secret"
$env:JD_SITE_ID="your_site_id"
```

### æ–¹å¼2: ä¿®æ”¹application.yml

ç¼–è¾‘ `BuildMaster-API/src/main/resources/application.yml`:

```yaml
jd:
  api:
    enabled: true  # å¯ç”¨äº¬ä¸œAPI
    app-key: your_app_key_here
    app-secret: your_app_secret_here
    site-id: your_site_id_here
```

### æ–¹å¼3: Dockerç¯å¢ƒå˜é‡

åœ¨ `docker-compose.yml` ä¸­æ·»åŠ :

```yaml
services:
  buildmaster-api:
    environment:
      - JD_APP_KEY=your_app_key
      - JD_APP_SECRET=your_app_secret
      - JD_SITE_ID=your_site_id
```

---

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### 1. è‡ªåŠ¨ä»·æ ¼æ›´æ–°

- **é¢‘ç‡**: æ¯2å°æ—¶è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡
- **èŒƒå›´**: æ‰€æœ‰æœ‰äº¬ä¸œSKU IDçš„é…ä»¶
- **æ–¹å¼**: æ‰¹é‡æŸ¥è¯¢ï¼Œæé«˜æ•ˆç‡
- **é…ç½®**: å¯è‡ªå®šä¹‰æ›´æ–°é¢‘ç‡

### 2. æ¨å¹¿é“¾æ¥ç®¡ç†

- **é¢‘ç‡**: æ¯å¤©å‡Œæ™¨3ç‚¹æ›´æ–°
- **åŠŸèƒ½**: è‡ªåŠ¨ç”Ÿæˆäº¬ä¸œè”ç›Ÿæ¨å¹¿é“¾æ¥
- **æ”¶ç›Š**: é€šè¿‡æ¨å¹¿é“¾æ¥è´­ä¹°å¯è·å¾—ä½£é‡‘

### 3. æ•°æ®è¿½è¸ª

æ¯ä¸ªé…ä»¶è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š
- `price` - å½“å‰ä»·æ ¼
- `original_price` - åŸä»·
- `purchase_url` - è´­ä¹°é“¾æ¥ï¼ˆæ¨å¹¿é“¾æ¥ï¼‰
- `price_updated_at` - ä»·æ ¼æ›´æ–°æ—¶é—´
- `commission_rate` - ä½£é‡‘æ¯”ä¾‹
- `jd_sku_id` - äº¬ä¸œå•†å“ID

---

## ğŸ“¡ APIæ¥å£è¯´æ˜

### 1. æ›´æ–°æ‰€æœ‰é…ä»¶ä»·æ ¼

```http
POST /api/components/update-prices
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "successCount": 25,
  "failureCount": 0,
  "skipCount": 5,
  "totalCount": 30,
  "message": "ä»·æ ¼æ›´æ–°å®Œæˆ"
}
```

### 2. æ›´æ–°å•ä¸ªé…ä»¶ä»·æ ¼

```http
POST /api/components/{id}/update-price
```

**ç¤ºä¾‹:**
```bash
curl -X POST http://localhost:8080/api/components/1/update-price
```

**å“åº”:**
```json
{
  "success": true,
  "message": "ä»·æ ¼æ›´æ–°æˆåŠŸ"
}
```

### 3. æ›´æ–°æ‰€æœ‰æ¨å¹¿é“¾æ¥

```http
POST /api/components/update-promotion-urls
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "successCount": 28,
  "failureCount": 0,
  "skipCount": 2,
  "totalCount": 30,
  "message": "æ¨å¹¿é“¾æ¥æ›´æ–°å®Œæˆ"
}
```

### 4. æ›´æ–°å•ä¸ªæ¨å¹¿é“¾æ¥

```http
POST /api/components/{id}/update-promotion-url
```

---

## â° å®šæ—¶ä»»åŠ¡è¯´æ˜

### ä»·æ ¼æ›´æ–°ä»»åŠ¡

**é»˜è®¤é…ç½®:**
```yaml
price-update:
  cron: 0 0 */2 * * ?  # æ¯2å°æ—¶æ‰§è¡Œ
```

**è‡ªå®šä¹‰ç¤ºä¾‹:**
```yaml
# æ¯å°æ—¶æ‰§è¡Œ
cron: 0 0 * * * ?

# æ¯å¤©æ—©ä¸Š8ç‚¹æ‰§è¡Œ
cron: 0 0 8 * * ?

# æ¯30åˆ†é’Ÿæ‰§è¡Œ
cron: 0 */30 * * * ?
```

### æ¨å¹¿é“¾æ¥æ›´æ–°ä»»åŠ¡

**é»˜è®¤é…ç½®:**
```yaml
promotion-url-update:
  cron: 0 0 3 * * ?  # æ¯å¤©å‡Œæ™¨3ç‚¹æ‰§è¡Œ
```

**Cronè¡¨è¾¾å¼è¯´æ˜:**
```
æ ¼å¼: ç§’ åˆ† æ—¶ æ—¥ æœˆ å‘¨

ç¤ºä¾‹:
0 0 12 * * ?    - æ¯å¤©ä¸­åˆ12ç‚¹
0 15 10 * * ?   - æ¯å¤©ä¸Šåˆ10:15
0 0 */4 * * ?   - æ¯4å°æ—¶
0 0 0 * * MON   - æ¯å‘¨ä¸€å‡Œæ™¨
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: é¦–æ¬¡é…ç½®å¹¶æµ‹è¯•

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
export JD_APP_KEY=your_app_key
export JD_APP_SECRET=your_app_secret
export JD_SITE_ID=your_site_id

# 2. ä¿®æ”¹é…ç½®æ–‡ä»¶å¯ç”¨API
# ç¼–è¾‘ application.ymlï¼Œè®¾ç½® enabled: true

# 3. å¯åŠ¨åº”ç”¨
cd BuildMaster-API
mvn spring-boot:run

# 4. å¯¼å…¥æµ‹è¯•é…ä»¶
curl -X POST http://localhost:8080/api/components/import/popular

# 5. æ‰‹åŠ¨è§¦å‘ä»·æ ¼æ›´æ–°
curl -X POST http://localhost:8080/api/components/update-prices
```

### ç¤ºä¾‹2: ä¸ºé…ä»¶æ·»åŠ äº¬ä¸œSKU ID

```bash
# æ›´æ–°é…ä»¶ï¼Œæ·»åŠ äº¬ä¸œSKU ID
curl -X PUT http://localhost:8080/api/components/1 \
  -H "Content-Type: application/json" \
  -d '{
    "id": 1,
    "name": "Intel i7-13700K",
    "type": "CPU",
    "price": 2999.00,
    "jdSkuId": "100035246116"
  }'

# è§¦å‘å•ä¸ªé…ä»¶ä»·æ ¼æ›´æ–°
curl -X POST http://localhost:8080/api/components/1/update-price

# ç”Ÿæˆæ¨å¹¿é“¾æ¥
curl -X POST http://localhost:8080/api/components/1/update-promotion-url
```

### ç¤ºä¾‹3: æ‰¹é‡å¯¼å…¥å¸¦SKU IDçš„é…ä»¶

åˆ›å»º `components.csv`:
```csv
åç§°,ç±»å‹,å“ç‰Œ,å‹å·,ä»·æ ¼,äº¬ä¸œSKU ID
Intel i9-13900K,CPU,Intel,i9-13900K,4499.00,100035246114
RTX 4090,GPU,NVIDIA,RTX 4090,12999.00,100043754698
```

ä¸Šä¼ å¯¼å…¥:
```bash
curl -X POST http://localhost:8080/api/components/import/csv \
  -F "file=@components.csv"
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: APIè°ƒç”¨å¤±è´¥ï¼Œè¿”å›ç­¾åé”™è¯¯ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ:**
- æ£€æŸ¥AppKeyå’ŒAppSecretæ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç³»ç»Ÿæ—¶é—´å‡†ç¡®ï¼ˆç­¾ååŒ…å«æ—¶é—´æˆ³ï¼‰
- æ£€æŸ¥å‚æ•°æ˜¯å¦URLç¼–ç 

### Q2: ä»·æ ¼æŸ¥è¯¢è¿”å›ç©ºç»“æœï¼Ÿ

**å¯èƒ½åŸå› :**
- äº¬ä¸œSKU IDä¸æ­£ç¡®
- å•†å“å·²ä¸‹æ¶
- APIæƒé™æœªå¼€é€š

**è§£å†³æ–¹æ¡ˆ:**
```bash
# éªŒè¯SKU ID
# è®¿é—®: https://item.jd.com/{sku_id}.html
# ä¾‹å¦‚: https://item.jd.com/100035246116.html
```

### Q3: å®šæ—¶ä»»åŠ¡ä¸æ‰§è¡Œï¼Ÿ

**æ£€æŸ¥æ­¥éª¤:**
1. ç¡®è®¤`@EnableScheduling`å·²å¯ç”¨
2. æ£€æŸ¥æ—¥å¿—è¾“å‡º
3. éªŒè¯cronè¡¨è¾¾å¼æ ¼å¼
4. ç¡®è®¤`jd.api.enabled=true`

### Q4: æ¨å¹¿é“¾æ¥ç”Ÿæˆå¤±è´¥ï¼Ÿ

**å¸¸è§åŸå› :**
- æ¨å¹¿ä½ID (site-id) é…ç½®é”™è¯¯
- APIæƒé™æœªç”³è¯·
- å•†å“ä¸æ”¯æŒæ¨å¹¿

### Q5: å¦‚ä½•è·å–äº¬ä¸œå•†å“çš„SKU IDï¼Ÿ

**æ–¹æ³•1: ä»å•†å“URLè·å–**
```
URL: https://item.jd.com/100035246116.html
SKU ID: 100035246116
```

**æ–¹æ³•2: ä½¿ç”¨æœç´¢API**
```java
List<Component> results = jdApiService.searchProducts("Intel i7-13700K", 10);
// ä»ç»“æœä¸­è·å– jdSkuId
```

### Q6: ä»·æ ¼æ›´æ–°é¢‘ç‡å¯ä»¥æ›´é«˜å—ï¼Ÿ

å¯ä»¥ï¼Œä½†éœ€æ³¨æ„ï¼š
- äº¬ä¸œAPIæœ‰é¢‘ç‡é™åˆ¶ï¼ˆæ¯å°æ—¶çº¦1000æ¬¡ï¼‰
- å»ºè®®æœ€çŸ­é—´éš”30åˆ†é’Ÿ
- æ‰¹é‡æŸ¥è¯¢æ¯”å•ä¸ªæŸ¥è¯¢æ›´é«˜æ•ˆ

### Q7: å¦‚ä½•ç›‘æ§APIè°ƒç”¨æƒ…å†µï¼Ÿ

æŸ¥çœ‹æ—¥å¿—:
```bash
# æŸ¥çœ‹ä»·æ ¼æ›´æ–°æ—¥å¿—
grep "ä»·æ ¼æ›´æ–°" logs/spring.log

# æŸ¥çœ‹APIè°ƒç”¨æ—¥å¿—
grep "äº¬ä¸œAPI" logs/spring.log
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ‰¹é‡æ›´æ–°ç­–ç•¥

```java
// âœ… æ¨èï¼šæ‰¹é‡æŸ¥è¯¢
Map<String, BigDecimal> prices = jdApiService.batchGetPrices(skuIds);

// âŒ ä¸æ¨èï¼šé€ä¸ªæŸ¥è¯¢
for (String skuId : skuIds) {
    BigDecimal price = jdApiService.getPrice(skuId);
}
```

### 2. ç¼“å­˜é…ç½®

ä»·æ ¼å’Œå•†å“ä¿¡æ¯å·²ä½¿ç”¨Spring Cacheç¼“å­˜:
- æœç´¢ç»“æœç¼“å­˜: 1å°æ—¶
- å•†å“è¯¦æƒ…ç¼“å­˜: 6å°æ—¶
- ä»·æ ¼ç¼“å­˜: 30åˆ†é’Ÿ

### 3. é¢‘ç‡é™åˆ¶

å»ºè®®é…ç½®:
- ä»·æ ¼æ›´æ–°: æ¯2-4å°æ—¶
- æ¨å¹¿é“¾æ¥: æ¯å¤©1æ¬¡
- é¿å…åœ¨é«˜å³°æœŸï¼ˆ10:00-22:00ï¼‰é¢‘ç¹è°ƒç”¨

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥**
   - ä½¿ç”¨ç¯å¢ƒå˜é‡
   - ä½¿ç”¨é…ç½®ä¸­å¿ƒï¼ˆå¦‚Spring Cloud Configï¼‰

2. **ä¿æŠ¤APIå¯†é’¥**
   - ä¸è¦æäº¤åˆ°Gitä»“åº“
   - æ·»åŠ åˆ°`.gitignore`

3. **ç›‘æ§å¼‚å¸¸è°ƒç”¨**
   - è®°å½•æ‰€æœ‰APIè°ƒç”¨æ—¥å¿—
   - è®¾ç½®å‘Šè­¦è§„åˆ™

---

## ğŸ“ˆ æ”¶ç›Šè·Ÿè¸ª

é€šè¿‡äº¬ä¸œè”ç›Ÿæ¨å¹¿é“¾æ¥ï¼Œå¯ä»¥è·å¾—ä½£é‡‘æ”¶ç›Šï¼š

1. **ä½£é‡‘æ¯”ä¾‹**: å­˜å‚¨åœ¨ `commission_rate` å­—æ®µ
2. **æ”¶ç›ŠæŸ¥è¯¢**: ç™»å½•äº¬ä¸œè”ç›Ÿåå°æŸ¥çœ‹
3. **æ•°æ®æŠ¥è¡¨**: å¯å¯¼å‡ºæ”¶ç›Šæ˜ç»†

---

## ğŸ‰ æ€»ç»“

æ‚¨å·²æˆåŠŸé›†æˆäº¬ä¸œè”ç›ŸAPIï¼ç°åœ¨å¯ä»¥ï¼š

âœ… å®æ—¶æ›´æ–°é…ä»¶ä»·æ ¼
âœ… è‡ªåŠ¨ç”Ÿæˆæ¨å¹¿é“¾æ¥
âœ… å®šæ—¶åŒæ­¥å•†å“ä¿¡æ¯
âœ… è·å¾—æ¨å¹¿ä½£é‡‘æ”¶ç›Š

**ä¸‹ä¸€æ­¥å»ºè®®:**
1. ä¸ºç°æœ‰é…ä»¶æ·»åŠ äº¬ä¸œSKU ID
2. é…ç½®åˆé€‚çš„æ›´æ–°é¢‘ç‡
3. ç›‘æ§APIè°ƒç”¨æƒ…å†µ
4. ä¼˜åŒ–ç¼“å­˜ç­–ç•¥

**è·å–å¸®åŠ©:**
- äº¬ä¸œè”ç›Ÿå¸®åŠ©ä¸­å¿ƒ: https://union.jd.com/helpcenter/
- APIæ–‡æ¡£: https://union.jd.com/openplatform/api
- BuildMaster Issues: https://github.com/your-repo/issues

---

**Made with â¤ï¸ by BuildMaster Team**

